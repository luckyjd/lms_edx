/*
* Underscore.string
* (c) 2010 Esa-Matti Suuronen <esa-matti aet suuronen dot org>
* Underscore.string is freely distributable under the terms of the MIT license.
* Documentation: https://github.com/epeli/underscore.string
* Some code is borrowed from MooTools and Alexandru Marasteanu.
* Version '3.3.4'
* @preserve
*/

/*!
 * jQuery Cookie Plugin
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */

!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("underscore.string",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.s=e()}}(function(){var e;return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return r(n?n:t)},l,l.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){var i=e("./trim"),r=e("./decapitalize");t.exports=function(e,t){return e=i(e).replace(/[-_\s]+(.)?/g,function(e,t){return t?t.toUpperCase():""}),t===!0?r(e):e}},{"./decapitalize":10,"./trim":65}],2:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e);var n=t?e.slice(1).toLowerCase():e.slice(1);return e.charAt(0).toUpperCase()+n}},{"./helper/makeString":20}],3:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e){return i(e).split("")}},{"./helper/makeString":20}],4:[function(e,t,n){t.exports=function(e,t){return null==e?[]:(e=String(e),t=~~t,t>0?e.match(new RegExp(".{1,"+t+"}","g")):[e])}},{}],5:[function(e,t,n){var i=e("./capitalize"),r=e("./camelize"),o=e("./helper/makeString");t.exports=function(e){return e=o(e),i(r(e.replace(/[\W_]/g," ")).replace(/\s/g,""))}},{"./camelize":1,"./capitalize":2,"./helper/makeString":20}],6:[function(e,t,n){var i=e("./trim");t.exports=function(e){return i(e).replace(/\s\s+/g," ")}},{"./trim":65}],7:[function(e,t,n){var i=e("./helper/makeString"),r="ąàáäâãåæăćčĉęèéëêĝĥìíïîĵłľńňòóöőôõðøśșşšŝťțţŭùúüűûñÿýçżźž",o="aaaaaaaaaccceeeeeghiiiijllnnoooooooossssstttuuuuuunyyczzz";r+=r.toUpperCase(),o+=o.toUpperCase(),o=o.split(""),r+="ß",o.push("ss"),t.exports=function(e){return i(e).replace(/.{1}/g,function(e){var t=r.indexOf(e);return-1===t?e:o[t]})}},{"./helper/makeString":20}],8:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){return e=i(e),t=i(t),0===e.length||0===t.length?0:e.split(t).length-1}},{"./helper/makeString":20}],9:[function(e,t,n){var i=e("./trim");t.exports=function(e){return i(e).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()}},{"./trim":65}],10:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e){return e=i(e),e.charAt(0).toLowerCase()+e.slice(1)}},{"./helper/makeString":20}],11:[function(e,t,n){function i(e){for(var t=e.match(/^[\s\\t]*/gm),n=t[0].length,i=1;i<t.length;i++)n=Math.min(t[i].length,n);return n}var r=e("./helper/makeString");t.exports=function(e,t){e=r(e);var n,o=i(e);return 0===o?e:(n="string"==typeof t?new RegExp("^"+t,"gm"):new RegExp("^[ \\t]{"+o+"}","gm"),e.replace(n,""))}},{"./helper/makeString":20}],12:[function(e,t,n){var i=e("./helper/makeString"),r=e("./helper/toPositive");t.exports=function(e,t,n){return e=i(e),t=""+t,n="undefined"==typeof n?e.length-t.length:Math.min(r(n),e.length)-t.length,n>=0&&e.indexOf(t,n)===n}},{"./helper/makeString":20,"./helper/toPositive":22}],13:[function(e,t,n){var i=e("./helper/makeString"),r=e("./helper/escapeChars"),o="[";for(var s in r)o+=s;o+="]";var a=new RegExp(o,"g");t.exports=function(e){return i(e).replace(a,function(e){return"&"+r[e]+";"})}},{"./helper/escapeChars":17,"./helper/makeString":20}],14:[function(e,t,n){t.exports=function(){var e={};for(var t in this)this.hasOwnProperty(t)&&!t.match(/^(?:include|contains|reverse|join|map|wrap)$/)&&(e[t]=this[t]);return e}},{}],15:[function(e,t,n){var i=e("./makeString");t.exports=function(e,t){return e=i(e),0===e.length?"":e.slice(0,-1)+String.fromCharCode(e.charCodeAt(e.length-1)+t)}},{"./makeString":20}],16:[function(e,t,n){var i=e("./escapeRegExp");t.exports=function(e){return null==e?"\\s":e.source?e.source:"["+i(e)+"]"}},{"./escapeRegExp":18}],17:[function(e,t,n){var i={"¢":"cent","£":"pound","¥":"yen","€":"euro","©":"copy","®":"reg","<":"lt",">":"gt",'"':"quot","&":"amp","'":"#39"};t.exports=i},{}],18:[function(e,t,n){var i=e("./makeString");t.exports=function(e){return i(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}},{"./makeString":20}],19:[function(e,t,n){var i={nbsp:" ",cent:"¢",pound:"£",yen:"¥",euro:"€",copy:"©",reg:"®",lt:"<",gt:">",quot:'"',amp:"&",apos:"'"};t.exports=i},{}],20:[function(e,t,n){t.exports=function(e){return null==e?"":""+e}},{}],21:[function(e,t,n){t.exports=function(e,t){if(1>t)return"";for(var n="";t>0;)1&t&&(n+=e),t>>=1,e+=e;return n}},{}],22:[function(e,t,n){t.exports=function(e){return 0>e?0:+e||0}},{}],23:[function(e,t,n){var i=e("./capitalize"),r=e("./underscored"),o=e("./trim");t.exports=function(e){return i(o(r(e).replace(/_id$/,"").replace(/_/g," ")))}},{"./capitalize":2,"./trim":65,"./underscored":67}],24:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){return""===t?!0:-1!==i(e).indexOf(t)}},{"./helper/makeString":20}],25:[function(e,t,n){function i(e){return this instanceof i?void(this._wrapped=e):new i(e)}function r(e,t){"function"==typeof t&&(i.prototype[e]=function(){var e=[this._wrapped].concat(Array.prototype.slice.call(arguments)),n=t.apply(null,e);return"string"==typeof n?new i(n):n})}function o(e){r(e,function(t){var n=Array.prototype.slice.call(arguments,1);return String.prototype[e].apply(t,n)})}i.VERSION="3.3.4",i.isBlank=e("./isBlank"),i.stripTags=e("./stripTags"),i.capitalize=e("./capitalize"),i.decapitalize=e("./decapitalize"),i.chop=e("./chop"),i.trim=e("./trim"),i.clean=e("./clean"),i.cleanDiacritics=e("./cleanDiacritics"),i.count=e("./count"),i.chars=e("./chars"),i.swapCase=e("./swapCase"),i.escapeHTML=e("./escapeHTML"),i.unescapeHTML=e("./unescapeHTML"),i.splice=e("./splice"),i.insert=e("./insert"),i.replaceAll=e("./replaceAll"),i.include=e("./include"),i.join=e("./join"),i.lines=e("./lines"),i.dedent=e("./dedent"),i.reverse=e("./reverse"),i.startsWith=e("./startsWith"),i.endsWith=e("./endsWith"),i.pred=e("./pred"),i.succ=e("./succ"),i.titleize=e("./titleize"),i.camelize=e("./camelize"),i.underscored=e("./underscored"),i.dasherize=e("./dasherize"),i.classify=e("./classify"),i.humanize=e("./humanize"),i.ltrim=e("./ltrim"),i.rtrim=e("./rtrim"),i.truncate=e("./truncate"),i.prune=e("./prune"),i.words=e("./words"),i.pad=e("./pad"),i.lpad=e("./lpad"),i.rpad=e("./rpad"),i.lrpad=e("./lrpad"),i.sprintf=e("./sprintf"),i.vsprintf=e("./vsprintf"),i.toNumber=e("./toNumber"),i.numberFormat=e("./numberFormat"),i.strRight=e("./strRight"),i.strRightBack=e("./strRightBack"),i.strLeft=e("./strLeft"),i.strLeftBack=e("./strLeftBack"),i.toSentence=e("./toSentence"),i.toSentenceSerial=e("./toSentenceSerial"),i.slugify=e("./slugify"),i.surround=e("./surround"),i.quote=e("./quote"),i.unquote=e("./unquote"),i.repeat=e("./repeat"),i.naturalCmp=e("./naturalCmp"),i.levenshtein=e("./levenshtein"),i.toBoolean=e("./toBoolean"),i.exports=e("./exports"),i.escapeRegExp=e("./helper/escapeRegExp"),i.wrap=e("./wrap"),i.map=e("./map"),i.strip=i.trim,i.lstrip=i.ltrim,i.rstrip=i.rtrim,i.center=i.lrpad,i.rjust=i.lpad,i.ljust=i.rpad,i.contains=i.include,i.q=i.quote,i.toBool=i.toBoolean,i.camelcase=i.camelize,i.mapChars=i.map,i.prototype={value:function(){return this._wrapped}};for(var s in i)r(s,i[s]);r("tap",function(e,t){return t(e)});var a=["toUpperCase","toLowerCase","split","replace","slice","substring","substr","concat"];for(var u in a)o(a[u]);t.exports=i},{"./camelize":1,"./capitalize":2,"./chars":3,"./chop":4,"./classify":5,"./clean":6,"./cleanDiacritics":7,"./count":8,"./dasherize":9,"./decapitalize":10,"./dedent":11,"./endsWith":12,"./escapeHTML":13,"./exports":14,"./helper/escapeRegExp":18,"./humanize":23,"./include":24,"./insert":26,"./isBlank":27,"./join":28,"./levenshtein":29,"./lines":30,"./lpad":31,"./lrpad":32,"./ltrim":33,"./map":34,"./naturalCmp":35,"./numberFormat":38,"./pad":39,"./pred":40,"./prune":41,"./quote":42,"./repeat":43,"./replaceAll":44,"./reverse":45,"./rpad":46,"./rtrim":47,"./slugify":48,"./splice":49,"./sprintf":50,"./startsWith":51,"./strLeft":52,"./strLeftBack":53,"./strRight":54,"./strRightBack":55,"./stripTags":56,"./succ":57,"./surround":58,"./swapCase":59,"./titleize":60,"./toBoolean":61,"./toNumber":62,"./toSentence":63,"./toSentenceSerial":64,"./trim":65,"./truncate":66,"./underscored":67,"./unescapeHTML":68,"./unquote":69,"./vsprintf":70,"./words":71,"./wrap":72}],26:[function(e,t,n){var i=e("./splice");t.exports=function(e,t,n){return i(e,t,0,n)}},{"./splice":49}],27:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e){return/^\s*$/.test(i(e))}},{"./helper/makeString":20}],28:[function(e,t,n){var i=e("./helper/makeString"),r=[].slice;t.exports=function(){var e=r.call(arguments),t=e.shift();return e.join(i(t))}},{"./helper/makeString":20}],29:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){"use strict";if(e=i(e),t=i(t),e===t)return 0;if(!e||!t)return Math.max(e.length,t.length);for(var n=new Array(t.length+1),r=0;r<n.length;++r)n[r]=r;for(r=0;r<e.length;++r){for(var o=r+1,s=0;s<t.length;++s){var a=o;o=n[s]+(e.charAt(r)===t.charAt(s)?0:1);var u=a+1;o>u&&(o=u),u=n[s+1]+1,o>u&&(o=u),n[s]=a}n[s]=o}return o}},{"./helper/makeString":20}],30:[function(e,t,n){t.exports=function(e){return null==e?[]:String(e).split(/\r\n?|\n/)}},{}],31:[function(e,t,n){var i=e("./pad");t.exports=function(e,t,n){return i(e,t,n)}},{"./pad":39}],32:[function(e,t,n){var i=e("./pad");t.exports=function(e,t,n){return i(e,t,n,"both")}},{"./pad":39}],33:[function(e,t,n){var i=e("./helper/makeString"),r=e("./helper/defaultToWhiteSpace"),o=String.prototype.trimLeft;t.exports=function(e,t){return e=i(e),!t&&o?o.call(e):(t=r(t),e.replace(new RegExp("^"+t+"+"),""))}},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":20}],34:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){return e=i(e),0===e.length||"function"!=typeof t?e:e.replace(/./g,t)}},{"./helper/makeString":20}],35:[function(e,t,n){t.exports=function(e,t){if(e==t)return 0;if(!e)return-1;if(!t)return 1;for(var n=/(\.\d+|\d+|\D+)/g,i=String(e).match(n),r=String(t).match(n),o=Math.min(i.length,r.length),s=0;o>s;s++){var a=i[s],u=r[s];if(a!==u){var c=+a,l=+u;return c===c&&l===l?c>l?1:-1:u>a?-1:1}}return i.length!=r.length?i.length-r.length:t>e?-1:1}},{}],36:[function(t,n,i){!function(t){function n(){var e=arguments[0],t=n.cache;return t[e]&&t.hasOwnProperty(e)||(t[e]=n.parse(e)),n.format.call(null,t[e],arguments)}function r(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function o(e,t){return Array(t+1).join(e)}var s={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};n.format=function(e,t){var i,a,u,c,l,p,d,h=1,f=e.length,g="",m=[],v=!0,w="";for(a=0;f>a;a++)if(g=r(e[a]),"string"===g)m[m.length]=e[a];else if("array"===g){if(c=e[a],c[2])for(i=t[h],u=0;u<c[2].length;u++){if(!i.hasOwnProperty(c[2][u]))throw new Error(n("[sprintf] property '%s' does not exist",c[2][u]));i=i[c[2][u]]}else i=c[1]?t[c[1]]:t[h++];if("function"==r(i)&&(i=i()),s.not_string.test(c[8])&&s.not_json.test(c[8])&&"number"!=r(i)&&isNaN(i))throw new TypeError(n("[sprintf] expecting number but found %s",r(i)));switch(s.number.test(c[8])&&(v=i>=0),c[8]){case"b":i=i.toString(2);break;case"c":i=String.fromCharCode(i);break;case"d":case"i":i=parseInt(i,10);break;case"j":i=JSON.stringify(i,null,c[6]?parseInt(c[6]):0);break;case"e":i=c[7]?i.toExponential(c[7]):i.toExponential();break;case"f":i=c[7]?parseFloat(i).toFixed(c[7]):parseFloat(i);break;case"g":i=c[7]?parseFloat(i).toPrecision(c[7]):parseFloat(i);break;case"o":i=i.toString(8);break;case"s":i=(i=String(i))&&c[7]?i.substring(0,c[7]):i;break;case"u":i>>>=0;break;case"x":i=i.toString(16);break;case"X":i=i.toString(16).toUpperCase()}s.json.test(c[8])?m[m.length]=i:(!s.number.test(c[8])||v&&!c[3]?w="":(w=v?"+":"-",i=i.toString().replace(s.sign,"")),p=c[4]?"0"===c[4]?"0":c[4].charAt(1):" ",d=c[6]-(w+i).length,l=c[6]&&d>0?o(p,d):"",m[m.length]=c[5]?w+i+l:"0"===p?w+l+i:l+w+i)}return m.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],i=[],r=0;t;){if(null!==(n=s.text.exec(t)))i[i.length]=n[0];else if(null!==(n=s.modulo.exec(t)))i[i.length]="%";else{if(null===(n=s.placeholder.exec(t)))throw new SyntaxError("[sprintf] unexpected placeholder");if(n[2]){r|=1;var o=[],a=n[2],u=[];if(null===(u=s.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o[o.length]=u[1];""!==(a=a.substring(u[0].length));)if(null!==(u=s.key_access.exec(a)))o[o.length]=u[1];else{if(null===(u=s.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");o[o.length]=u[1]}n[2]=o}else r|=2;if(3===r)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i[i.length]=n}t=t.substring(n[0].length)}return i};var a=function(e,t,i){return i=(t||[]).slice(0),i.splice(0,0,e),n.apply(null,i)};"undefined"!=typeof i?(i.sprintf=n,i.vsprintf=a):(t.sprintf=n,t.vsprintf=a,"function"==typeof e&&e.amd&&e(function(){return{sprintf:n,vsprintf:a}}))}("undefined"==typeof window?this:window)},{}],37:[function(e,t,n){(function(e){function n(e,t){function n(){if(!r){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}if(i("noDeprecation"))return e;var r=!1;return n}function i(t){try{if(!e.localStorage)return!1}catch(n){return!1}var i=e.localStorage[t];return null==i?!1:"true"===String(i).toLowerCase()}t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],38:[function(e,t,n){t.exports=function(e,t,n,i){if(isNaN(e)||null==e)return"";e=e.toFixed(~~t),i="string"==typeof i?i:",";var r=e.split("."),o=r[0],s=r[1]?(n||".")+r[1]:"";return o.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+i)+s}},{}],39:[function(e,t,n){var i=e("./helper/makeString"),r=e("./helper/strRepeat");t.exports=function(e,t,n,o){e=i(e),t=~~t;var s=0;switch(n?n.length>1&&(n=n.charAt(0)):n=" ",o){case"right":return s=t-e.length,e+r(n,s);case"both":return s=t-e.length,r(n,Math.ceil(s/2))+e+r(n,Math.floor(s/2));default:return s=t-e.length,r(n,s)+e}}},{"./helper/makeString":20,"./helper/strRepeat":21}],40:[function(e,t,n){var i=e("./helper/adjacent");t.exports=function(e){return i(e,-1)}},{"./helper/adjacent":15}],41:[function(e,t,n){var i=e("./helper/makeString"),r=e("./rtrim");t.exports=function(e,t,n){if(e=i(e),t=~~t,n=null!=n?String(n):"...",e.length<=t)return e;var o=function(e){return e.toUpperCase()!==e.toLowerCase()?"A":" "},s=e.slice(0,t+1).replace(/.(?=\W*\w*$)/g,o);return s=s.slice(s.length-2).match(/\w\w/)?s.replace(/\s*\S+$/,""):r(s.slice(0,s.length-1)),(s+n).length>e.length?e:e.slice(0,s.length)+n}},{"./helper/makeString":20,"./rtrim":47}],42:[function(e,t,n){var i=e("./surround");t.exports=function(e,t){return i(e,t||'"')}},{"./surround":58}],43:[function(e,t,n){var i=e("./helper/makeString"),r=e("./helper/strRepeat");t.exports=function o(e,t,n){if(e=i(e),t=~~t,null==n)return r(e,t);for(var o=[];t>0;o[--t]=e);return o.join(n)}},{"./helper/makeString":20,"./helper/strRepeat":21}],44:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t,n,r){var o=r===!0?"gi":"g",s=new RegExp(t,o);return i(e).replace(s,n)}},{"./helper/makeString":20}],45:[function(e,t,n){var i=e("./chars");t.exports=function(e){return i(e).reverse().join("")}},{"./chars":3}],46:[function(e,t,n){var i=e("./pad");t.exports=function(e,t,n){return i(e,t,n,"right")}},{"./pad":39}],47:[function(e,t,n){var i=e("./helper/makeString"),r=e("./helper/defaultToWhiteSpace"),o=String.prototype.trimRight;t.exports=function(e,t){return e=i(e),!t&&o?o.call(e):(t=r(t),e.replace(new RegExp(t+"+$"),""))}},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":20}],48:[function(e,t,n){var i=e("./trim"),r=e("./dasherize"),o=e("./cleanDiacritics");t.exports=function(e){return i(r(o(e).replace(/[^\w\s-]/g,"-").toLowerCase()),"-")}},{"./cleanDiacritics":7,"./dasherize":9,"./trim":65}],49:[function(e,t,n){var i=e("./chars");t.exports=function(e,t,n,r){var o=i(e);return o.splice(~~t,~~n,r),o.join("")}},{"./chars":3}],50:[function(e,t,n){var i=e("util-deprecate");t.exports=i(e("sprintf-js").sprintf,"sprintf() will be removed in the next major release, use the sprintf-js package instead.")},{"sprintf-js":36,"util-deprecate":37}],51:[function(e,t,n){var i=e("./helper/makeString"),r=e("./helper/toPositive");t.exports=function(e,t,n){return e=i(e),t=""+t,n=null==n?0:Math.min(r(n),e.length),e.lastIndexOf(t,n)===n}},{"./helper/makeString":20,"./helper/toPositive":22}],52:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=i(t);var n=t?e.indexOf(t):-1;return~n?e.slice(0,n):e}},{"./helper/makeString":20}],53:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=i(t);var n=e.lastIndexOf(t);return~n?e.slice(0,n):e}},{"./helper/makeString":20}],54:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=i(t);var n=t?e.indexOf(t):-1;return~n?e.slice(n+t.length,e.length):e}},{"./helper/makeString":20}],55:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=i(t);var n=t?e.lastIndexOf(t):-1;return~n?e.slice(n+t.length,e.length):e}},{"./helper/makeString":20}],56:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e){return i(e).replace(/<\/?[^>]+>/g,"")}},{"./helper/makeString":20}],57:[function(e,t,n){var i=e("./helper/adjacent");t.exports=function(e){return i(e,1)}},{"./helper/adjacent":15}],58:[function(e,t,n){t.exports=function(e,t){return[t,e,t].join("")}},{}],59:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e){return i(e).replace(/\S/g,function(e){return e===e.toUpperCase()?e.toLowerCase():e.toUpperCase()})}},{"./helper/makeString":20}],60:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e){return i(e).toLowerCase().replace(/(?:^|\s|-)\S/g,function(e){return e.toUpperCase()})}},{"./helper/makeString":20}],61:[function(e,t,n){function i(e,t){var n,i,r=e.toLowerCase();for(t=[].concat(t),n=0;n<t.length;n+=1)if(i=t[n]){if(i.test&&i.test(e))return!0;if(i.toLowerCase()===r)return!0}}var r=e("./trim");t.exports=function(e,t,n){return"number"==typeof e&&(e=""+e),"string"!=typeof e?!!e:(e=r(e),i(e,t||["true","1"])?!0:i(e,n||["false","0"])?!1:void 0)}},{"./trim":65}],62:[function(e,t,n){t.exports=function(e,t){if(null==e)return 0;var n=Math.pow(10,isFinite(t)?t:0);return Math.round(e*n)/n}},{}],63:[function(e,t,n){var i=e("./rtrim");t.exports=function(e,t,n,r){t=t||", ",n=n||" and ";var o=e.slice(),s=o.pop();return e.length>2&&r&&(n=i(t)+n),o.length?o.join(t)+n+s:s}},{"./rtrim":47}],64:[function(e,t,n){var i=e("./toSentence");t.exports=function(e,t,n){return i(e,t,n,!0)}},{"./toSentence":63}],65:[function(e,t,n){var i=e("./helper/makeString"),r=e("./helper/defaultToWhiteSpace"),o=String.prototype.trim;t.exports=function(e,t){return e=i(e),!t&&o?o.call(e):(t=r(t),e.replace(new RegExp("^"+t+"+|"+t+"+$","g"),""))}},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":20}],66:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t,n){return e=i(e),n=n||"...",t=~~t,e.length>t?e.slice(0,t)+n:e}},{"./helper/makeString":20}],67:[function(e,t,n){var i=e("./trim");t.exports=function(e){return i(e).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()}},{"./trim":65}],68:[function(e,t,n){var i=e("./helper/makeString"),r=e("./helper/htmlEntities");t.exports=function(e){return i(e).replace(/\&([^;]+);/g,function(e,t){var n;return t in r?r[t]:(n=t.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(n[1],16)):(n=t.match(/^#(\d+)$/))?String.fromCharCode(~~n[1]):e})}},{"./helper/htmlEntities":19,"./helper/makeString":20}],69:[function(e,t,n){t.exports=function(e,t){return t=t||'"',e[0]===t&&e[e.length-1]===t?e.slice(1,e.length-1):e}},{}],70:[function(e,t,n){var i=e("util-deprecate");t.exports=i(e("sprintf-js").vsprintf,"vsprintf() will be removed in the next major release, use the sprintf-js package instead.")},{"sprintf-js":36,"util-deprecate":37}],71:[function(e,t,n){var i=e("./isBlank"),r=e("./trim");t.exports=function(e,t){return i(e)?[]:r(e,t).split(t||/\s+/)}},{"./isBlank":27,"./trim":65}],72:[function(e,t,n){var i=e("./helper/makeString");t.exports=function(e,t){e=i(e),t=t||{};var n,r=t.width||75,o=t.seperator||"\n",s=t.cut||!1,a=t.preserveSpaces||!1,u=t.trailingSpaces||!1;if(0>=r)return e;if(s){var c=0;for(n="";c<e.length;)c%r==0&&c>0&&(n+=o),n+=e.charAt(c),c++;if(u)for(;c%r>0;)n+=" ",c++;return n}var l=e.split(" "),p=0;for(n="";l.length>0;){if(1+l[0].length+p>r&&p>0){if(a)n+=" ",p++;else if(u)for(;r>p;)n+=" ",p++;n+=o,p=0}p>0&&(n+=" ",p++),n+=l[0],p+=l[0].length,l.shift()}if(u)for(;r>p;)n+=" ",p++;return n}},{"./helper/makeString":20}]},{},[25])(25)}),function(){var e,t,n,i,r,o,s,a,u,c,l=this;"undefined"==typeof window?(e=require("underscore"),t=require("backbone"),"undefined"!=typeof exports&&(exports=module.exports=t)):(e=l._,t=l.Backbone),n=t.Model,i=t.Collection,r=n.prototype,o=i.prototype,u=/[\.\[\]]+/g,s="change add remove reset sort destroy".split(" "),c=["reset","sort"],t.Associations={VERSION:"0.5.0"},t.Associations.Many=t.Many="Many",t.Associations.One=t.One="One",a=t.AssociatedModel=t.Associations.AssociatedModel=n.extend({relations:void 0,_proxyCalls:void 0,get:function(e){var t=r.get.call(this,e);return t?t:this._getAttr.apply(this,arguments)},set:function(t,n,i){var r;return e.isObject(t)||null==t?(r=t,i=n):(r={},r[t]=n),t=this._set(r,i),this._processPendingEvents(),t},_set:function(t,n){var i,r,o,s,c=this;if(!t)return this;for(i in t)if(r||(r={}),i.match(u)){var l=d(i);s=e.initial(l),l=l[l.length-1],s=this.get(s),s instanceof a&&(s=r[s.cid]||(r[s.cid]={model:s,data:{}}),s.data[l]=t[i])}else s=r[this.cid]||(r[this.cid]={model:this,data:{}}),s.data[i]=t[i];if(r)for(o in r)s=r[o],this._setAttr.call(s.model,s.data,n)||(c=!1);else c=this._setAttr.call(this,t,n);return c},_setAttr:function(n,o){var s;if(o||(o={}),o.unset)for(s in n)n[s]=void 0;return this.parents=this.parents||[],this.relations&&e.each(this.relations,function(r){var s,u,c,l,p=r.key,d=r.relatedModel,f=r.collectionType,g=r.map,m=this.attributes[p],v=m&&m.idAttribute;if(d&&e.isString(d)&&(d=h(d)),f&&e.isString(f)&&(f=h(f)),g&&e.isString(g)&&(g=h(g)),u=r.options?e.extend({},r.options,o):o,n[p]){if(s=e.result(n,p),s=g?g(s):s,r.type===t.Many){if(f&&!f.prototype instanceof i)throw Error("collectionType must inherit from Backbone.Collection");s instanceof i?c=s:m?(m._deferEvents=!0,m.set(s,o),c=m):(c=f?new f:this._createCollection(d),c.add(s,u))}else r.type===t.One&&d&&(s instanceof a?c=s:m&&m&&s[v]&&m.get(v)===s[v]?(m._deferEvents=!0,m._set(s,o),c=m):c=new d(s,u));(l=n[p]=c)&&!l._proxyCallback&&(l._proxyCallback=function(){return this._bubbleEvent.call(this,p,l,arguments)},l.on("all",l._proxyCallback,this))}n.hasOwnProperty(p)&&(r=n[p],d=this.attributes[p],r?(r.parents=r.parents||[],-1==e.indexOf(r.parents,this)&&r.parents.push(this)):d&&d.parents.length>0&&(d.parents=e.difference(d.parents,[this])))},this),r.set.call(this,n,o)},_bubbleEvent:function(t,n,r){var o,u=r[0].split(":"),l=u[0],p="nested-change"==r[0],h=r[1],f=r[2],g=-1,m=n._proxyCalls,v=-1!==e.indexOf(s,l);if(!p){if(e.size(u)>1&&(o=u[1]),-1!==e.indexOf(c,l)&&(f=h),n instanceof i&&v&&h){var w=d(o),x=e.initial(w);(u=n.find(function(e){if(h===e)return!0;if(!e)return!1;var t=e.get(x);return(t instanceof a||t instanceof i)&&h===t?!0:(t=e.get(w),(t instanceof a||t instanceof i)&&h===t||t instanceof i&&f&&f===t?!0:void 0)}))&&(g=n.indexOf(u))}return o=t+(-1===g||"change"!==l&&!o?"":"["+g+"]")+(o?"."+o:""),/\[\*\]/g.test(o)?this:(u=o.replace(/\[\d+\]/g,"[*]"),g=[],g.push.apply(g,r),g[0]=l+":"+o,m=n._proxyCalls=m||{},this._isEventAvailable.call(this,m,o)?this:(m[o]=!0,"change"===l&&(this._previousAttributes[t]=n._previousAttributes,this.changed[t]=n),this.trigger.apply(this,g),"change"===l&&this.get(o)!=r[2]&&this.trigger.apply(this,["nested-change",o,r[1]]),m&&o&&delete m[o],o!==u&&(g[0]=l+":"+u,this.trigger.apply(this,g)),this))}},_isEventAvailable:function(t,n){return e.find(t,function(e,t){return-1!==n.indexOf(t,n.length-t.length)})},_createCollection:function(t){var n=t;if(e.isString(n)&&(n=h(n)),!(n&&n.prototype instanceof a))throw Error("type must inherit from Backbone.AssociatedModel");return t=new i,t.model=n,t},_processPendingEvents:function(){this.visited||(this.visited=!0,this._deferEvents=!1,e.each(this._pendingEvents,function(e){e.c.trigger.apply(e.c,e.a)}),this._pendingEvents=[],e.each(this.relations,function(e){(e=this.attributes[e.key])&&e._processPendingEvents()},this),delete this.visited)},trigger:function(e){this._deferEvents?(this._pendingEvents=this._pendingEvents||[],this._pendingEvents.push({c:this,a:arguments})):r.trigger.apply(this,arguments)},toJSON:function(t){var n,i;return this.visited||(this.visited=!0,n=r.toJSON.apply(this,arguments),this.relations&&e.each(this.relations,function(r){var o=this.attributes[r.key];o&&(i=o.toJSON(t),n[r.key]=e.isArray(i)?e.compact(i):i)},this),delete this.visited),n},clone:function(){return new this.constructor(this.toJSON())},_getAttr:function(t){var n,r,o=this,t=d(t);if(!(e.size(t)<1)){for(r=0;r<t.length&&(n=t[r],o);r++)o=o instanceof i?isNaN(n)?void 0:o.at(n):o.attributes[n];return o}}});var p=/[^\.\[\]]+/g,d=function(t){return""===t?[""]:e.isString(t)?t.match(p):t||[]},h=function(t){return e.reduce(t.split("."),function(e,t){return e[t]},l)},f=function(t,n,i){var r;return e.find(t,function(t){return(r=e.find(t.relations,function(e){return t.get(e.key)===n},this))?!0:void 0},this),r&&r.map?r.map(i):i},g={};e.each(["set","remove","reset"],function(e){g[e]=i.prototype[e],o[e]=function(t,n){return this.model.prototype instanceof a&&this.parents&&(arguments[0]=f(this.parents,this,t)),g[e].apply(this,arguments)}}),g.trigger=o.trigger,o.trigger=function(e){this._deferEvents?(this._pendingEvents=this._pendingEvents||[],this._pendingEvents.push({c:this,a:arguments})):g.trigger.apply(this,arguments)},o._processPendingEvents=a.prototype._processPendingEvents}.call(this),define("backbone.associations",["backbone"],function(e){return function(){var t;return t||e.Backbone.Associations}}(this)),define("js/models/group",["backbone","underscore","underscore.string","gettext","backbone.associations"],function(e,t,n,i){"use strict";var r=e.AssociatedModel.extend({defaults:function(){return{name:"",version:1,order:null,usage:[]}},url:function(){var e=this.collection.parents[0];return e.urlRoot+"/"+encodeURIComponent(e.id)+"/"+encodeURIComponent(this.id)},reset:function(){this.set(this._originalAttributes,{parse:!0})},isEmpty:function(){return!this.get("name")},toJSON:function(){return{id:this.get("id"),name:this.get("name"),version:this.get("version"),usage:this.get("usage")}},validate:function(e){return n.trim(e.name)?void 0:{message:i("Group name is required"),attributes:{name:!0}}}});return r}),define("js/collections/group",["underscore","underscore.string","backbone","gettext","js/models/group"],function(e,t,n,i,r){"use strict";var o=n.Collection.extend({model:r,comparator:"order",nextOrder:function(){return this.length?this.last().get("order")+1:0},isEmpty:function(){return 0===this.length||this.every(function(e){return e.isEmpty()})},getNextDefaultGroupName:function(){var n=this.nextOrder(),r=e.pluck(this.toJSON(),"name"),o="";do o=t.sprintf(i("Group %s"),this.getGroupId(n)),n++;while(e.contains(r,o));return o},getGroupId:function(){var t,n=i("ABCDEFGHIJKLMNOPQRSTUVWXYZ").split(""),r=n.length;return t=function(t,n){return e.isNumber(t)&&n?{quotient:t/n,remainder:t%n}:null},function o(e){var i,s="",a=t(e,r);return a?(i=Math.floor(a.quotient)-1,r>i?i>-1&&(s+=n[i]):s+=o(i),s+n[a.remainder]):String(e)}}()});return o}),function(){this.AjaxPrefix={addAjaxPrefix:function(e,t){return e.postWithPrefix=function(e,n,i,r){return $.post(""+t()+e,n,i,r)},e.getWithPrefix=function(e,n,i,r){return $.get(""+t()+e,n,i,r)},e.ajaxWithPrefix=function(e,n){return null!=n?$.ajax(""+t()+e,n):(n=e,n.url=""+t()+n.url,$.ajax(n))}}}}.call(this),define("coffee/src/ajax_prefix",function(){}),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!common/templates/components/system-feedback.underscore",[],function(){return'<div class="wrapper wrapper-<%= type %> wrapper-<%= type %>-<%= intent %>\n            <% if(obj.shown) { %>is-shown<% } else { %>is-hiding<% } %>\n            <% if(_.contains([\'help\', \'mini\'], intent)) { %>wrapper-<%= type %>-status<% } %>"\n     id="<%= type %>-<%= intent %>"\n     aria-hidden="<% if(obj.shown) { %>false<% } else { %>true<% } %>"\n     aria-labelledby="<%= type %>-<%= intent %>-title"\n     tabindex="-1"\n     <% if (obj.message) { %>aria-describedby="<%= type %>-<%= intent %>-description" <% } %>\n     <% if (obj.actions) { %>role="dialog"<% } %>\n  >\n  <div class="<%= type %> <%= intent %> <% if(obj.actions) { %>has-actions<% } %>">\n    <% if(obj.icon) { %>\n      <% var iconClass = {"warning": "warning", "confirmation": "check", "error": "warning", "announcement": "bullhorn", "step-required": "exclamation-circle", "help": "question", "mini": "cog"} %>\n      <span class="feedback-symbol fa fa-<%= iconClass[intent] %>" aria-hidden="true"></span>\n    <% } %>\n\n    <div class="copy">\n      <h2 class="title title-3" id="<%= type %>-<%= intent %>-title"><%- title %></h2>\n      <% if(obj.message) { %><p class="message" id="<%= type %>-<%= intent %>-description"><%- message %></p><% } %>\n    </div>\n\n    <% if(obj.actions) { %>\n    <nav class="nav-actions">\n      <ul>\n        <% if(actions.primary) { %>\n        <li class="nav-item">\n          <button class="action-primary <%= actions.primary.class %>"><%- actions.primary.text %></button>\n        </li>\n        <% } %>\n        <% if(actions.secondary) {\n             _.each(actions.secondary, function(secondary) { %>\n        <li class="nav-item">\n          <button class="action-secondary <%= secondary.class %>"><%- secondary.text %></button>\n        </li>\n        <%   });\n           } %>\n      </ul>\n    </nav>\n    <% } %>\n\n    <% if(obj.closeIcon) { %>\n    <a href="#" rel="view" class="action action-close action-<%= type %>-close">\n      <span class="icon fa fa-times-circle" aria-hidden="true"></span>\n      <span class="label">close <%= type %></span>\n    </a>\n    <% } %>\n  </div>\n</div>\n'}),function(e){"use strict";e("common/js/components/views/feedback",["jquery","underscore","underscore.string","backbone","text!common/templates/components/system-feedback.underscore"],function(e,t,n,i,r){var o=["a[href]:not([tabindex='-1'])","area[href]:not([tabindex='-1'])","input:not([disabled]):not([tabindex='-1'])","select:not([disabled]):not([tabindex='-1'])","textarea:not([disabled]):not([tabindex='-1'])","button:not([disabled]):not([tabindex='-1'])","iframe:not([tabindex='-1'])","[tabindex]:not([tabindex='-1'])","[contentEditable=true]:not([tabindex='-1'])"],s=i.View.extend({options:{title:"",message:"",intent:null,type:null,shown:!0,icon:!0,closeIcon:!0,minShown:0,maxShown:1/0,outFocusElement:null},initialize:function(n){if(this.options=t.extend({},this.options,n),!this.options.type)throw"SystemFeedback: type required (given "+JSON.stringify(this.options)+")";if(!this.options.intent)throw"SystemFeedback: intent required (given "+JSON.stringify(this.options)+")";return this.setElement(e("#page-"+this.options.type)),this.options.actions&&this.options.actions.secondary&&!t.isArray(this.options.actions.secondary)&&(this.options.actions.secondary=[this.options.actions.secondary]),
this},inFocus:function(){this.options.outFocusElement=this.options.outFocusElement||document.activeElement,this.$(".wrapper").first().focus();var e=this.$(o.join());return e.on("keydown",function(t){9===t.which&&t.shiftKey&&t.target===e.first()[0]?(t.preventDefault(),e.last().focus()):9!==t.which||t.shiftKey||t.target!==e.last()[0]||(t.preventDefault(),e.first().focus())}),this},outFocus:function(){this.$(o.join()).off("keydown");return this.options.outFocusElement&&this.options.outFocusElement.focus(),this},show:function(){return clearTimeout(this.hideTimeout),this.options.shown=!0,this.shownAt=new Date,this.render(),e.isNumeric(this.options.maxShown)&&(this.hideTimeout=setTimeout(t.bind(this.hide,this),this.options.maxShown)),this},hide:function(){return this.shownAt&&e.isNumeric(this.options.minShown)&&this.options.minShown>new Date-this.shownAt?(clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout(t.bind(this.hide,this),this.options.minShown-(new Date-this.shownAt))):(this.options.shown=!1,delete this.shownAt,this.render()),this},events:{"click .action-close":"hide","click .action-primary":"primaryClick","click .action-secondary":"secondaryClick"},render:function(){var e=s["active_"+this.options.type];return e&&e!==this&&(e.stopListening(),e.undelegateEvents()),this.$el.html(t.template(r)(this.options)),s["active_"+this.options.type]=this,this},primaryClick:function(e){var t,n;t=this.options.actions,t&&(n=t.primary,n&&(n.preventDefault!==!1&&e.preventDefault(),n.click&&n.click.call(e.target,this,e)))},secondaryClick:function(e){var n,i,r,o;n=this.options.actions,n&&(i=n.secondary,i&&(o=0,e&&e.target&&(o=t.indexOf(this.$(".action-secondary"),e.target)),r=i[o],r.preventDefault!==!1&&e.preventDefault(),r.click&&r.click.call(e.target,this,e)))}});return s})}.call(this,define||RequireJS.define),function(e){"use strict";e("common/js/components/views/feedback_notification",["jquery","underscore","underscore.string","common/js/components/views/feedback"],function(e,t,n,i){var r,o,s=i.extend({options:e.extend({},i.prototype.options,{type:"notification",closeIcon:!1})});r=t.compose(n.capitalize,n.camelize),o=["warning","error","confirmation","announcement","step-required","help","mini"],t.each(o,function(t){var n;n=s.extend({options:e.extend({},s.prototype.options,{intent:t})}),s[r(t)]=n});var a=s.Mini.prototype.options;return a.minShown=1250,a.closeIcon=!1,s})}.call(this,define||RequireJS.define),function(e){e.cookie=function(t,n,i){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||null===n||void 0===n)){if(i=e.extend({},i),(null===n||void 0===n)&&(i.expires=-1),"number"==typeof i.expires){var r=i.expires,o=i.expires=new Date;o.setDate(o.getDate()+r)}return n=String(n),document.cookie=[encodeURIComponent(t),"=",i.raw?n:encodeURIComponent(n),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}i=n||{};for(var s,a=i.raw?function(e){return e}:decodeURIComponent,u=document.cookie.split("; "),c=0;s=u[c]&&u[c].split("=");c++)if(a(s[0])===t)return a(s[1]||"");return null}}(jQuery),define("jquery.cookie",["jquery"],function(e){return function(){var t;return t||e.jQuery.fn.cookie}}(this)),function(e){"use strict";define("cms/js/main",["domReady","jquery","underscore.string","backbone","gettext","common/js/components/views/feedback_notification","coffee/src/ajax_prefix","jquery.cookie"],function(t,n,i,r,o,s){var a;return a=function(){return e.addAjaxPrefix(jQuery,function(){return n("meta[name='path_prefix']").attr("content")}),window.CMS=window.CMS||{},window.CMS.URL=window.CMS.URL||{},window.onTouchBasedDevice=function(){return navigator.userAgent.match(/iPhone|iPod|iPad|Android/i)},_.extend(window.CMS,r.Events),r.emulateHTTP=!0,n.ajaxSetup({headers:{"X-CSRFToken":n.cookie("csrftoken")},dataType:"json"}),n(document).ajaxError(function(e,t,n){var i,r,a=o("This may be happening because of an error with our server or your internet connection. Try refreshing the page or making sure you are online.");if(n.notifyOnError!==!1)return r=t.getResponseHeader("content-type"),r&&r.indexOf("json")>-1&&t.responseText&&(a=JSON.parse(t.responseText).error),i=new s.Error({title:o("Studio's having trouble saving your work"),message:a}),console.log("Studio AJAX Error",{url:e.currentTarget.URL,response:t.responseText,status:t.status}),i.show()}),n.postJSON=function(e,t,i){return n.isFunction(t)&&(i=t,t=void 0),n.ajax({url:e,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(t),success:i})},t(function(){return window.onTouchBasedDevice()?n("body").addClass("touch-based-device"):void 0})},a(),a})}.call(this,AjaxPrefix),define("js/models/group_configuration",["backbone","underscore","gettext","js/models/group","js/collections/group","backbone.associations","cms/js/main"],function(e,t,n,i,r){"use strict";var o=e.AssociatedModel.extend({defaults:function(){return{name:"",scheme:"random",description:"",version:2,groups:new r([{name:n("Group A"),order:0},{name:n("Group B"),order:1}]),showGroups:!1,editing:!1,usage:[]}},relations:[{type:e.Many,key:"groups",relatedModel:i,collectionType:r}],initialize:function(e,t){return this.on("remove:groups",this.groupRemoved),this.canBeEmpty=t&&t.canBeEmpty,this.setOriginalAttributes(),this},setOriginalAttributes:function(){this._originalAttributes=this.parse(this.toJSON())},reset:function(){this.set(this._originalAttributes,{parse:!0,validate:!0})},isDirty:function(){return!t.isEqual(this._originalAttributes,this.parse(this.toJSON()))},isEmpty:function(){return!this.get("name")&&this.get("groups").isEmpty()},parse:function(e){var n=$.extend(!0,{},e);return t.each(n.groups,function(e,t){e.order=e.order||t}),n},toJSON:function(){return{id:this.get("id"),name:this.get("name"),scheme:this.get("scheme"),description:this.get("description"),version:this.get("version"),groups:this.get("groups").toJSON()}},validate:function(i){if(!i.name.trim())return{message:n("Group Configuration name is required."),attributes:{name:!0}};if(!this.canBeEmpty&&i.groups.length<1)return{message:n("There must be at least one group."),attributes:{groups:!0}};var r=new e.Collection,o=new e.Collection;if(i.groups.each(function(e){e.isValid()?r.add(e):o.add(e)}),!o.isEmpty())return{message:n("All groups must have a name."),attributes:{groups:o.toJSON()}};var s=r.map(function(e){return e.get("name")});return s.length!==t.uniq(s).length?{message:n("All groups must have a unique name."),attributes:{groups:r.toJSON()}}:void 0},groupRemoved:function(){this.setOriginalAttributes()}});return o}),define("js/collections/group_configuration",["backbone","js/models/group_configuration"],function(e,t){"use strict";var n=e.Collection.extend({model:t});return n}),define("js/utils/handle_iframe_binding",["jquery"],function(e){var t=function(t){var i=null;i="undefined"==typeof t?e("iframe, embed"):"undefined"!=typeof t.nodeName?e(t).find("iframe, embed"):t.$("iframe, embed"),n(i)},n=function(t){t.each(function(){if("IFRAME"===e(this).prop("tagName")){var t=e(this).attr("src");if(t){var n="wmode=transparent";if(-1!==t.indexOf("?")){var i=t.split("?");if(-1===i[1].search("wmode=transparent")){var r=i[1],o=i[0];e(this).attr("src",o+"?"+n+"&"+r)}}else 0!==t.lastIndexOf("javascript:",0)&&e(this).attr("src",t+"?"+n)}}else e(this).attr("wmode","transparent")})},i=function(t){if(t){var i=null,r=document.createElement("div");e(r).html(t),i=e(r).find("iframe, embed"),i.length>0&&(n(i),t=e(r).html())}return t};return{iframeBinding:t,iframeBindingHtml:i}}),define("js/utils/templates",["jquery","underscore"],function(e,t){var n=function(n){var i="#"+n+"-tpl",r=e(i).text();return r||console.error("Failed to load "+n+" template"),t.template(r)};return{loadTemplate:n}}),function(e){"use strict";e("common/js/components/views/feedback_prompt",["jquery","underscore","underscore.string","common/js/components/views/feedback"],function(e,t,n,i){var r,o,s=i.extend({options:e.extend({},i.prototype.options,{type:"prompt",closeIcon:!1,icon:!1}),render:function(){return window.$body||(window.$body=e(document.body)),this.options.shown?$body.addClass("prompt-is-shown"):$body.removeClass("prompt-is-shown"),i.prototype.render.apply(this,arguments)},show:function(){return i.prototype.show.apply(this,arguments),this.inFocus()},hide:function(){return i.prototype.hide.apply(this,arguments),this.outFocus()}});return r=t.compose(n.capitalize,n.camelize),o=["warning","error","confirmation","announcement","step-required","help","mini"],t.each(o,function(t){var n;n=s.extend({options:e.extend({},s.prototype.options,{intent:t})}),s[r(t)]=n}),s})}.call(this,define||RequireJS.define),function(e,t){"use strict";e("common/js/components/utils/view_utils",["jquery","underscore","gettext","common/js/components/views/feedback_notification","common/js/components/views/feedback_prompt"],function(e,n,i,r,o){var s,a,u,c,l,p,d,h,f,g,m,v,w,x,y,b,S,k,j,C=65;return s=function(e,t){t||(t="collapsed"),e.closest(".expand-collapse").toggleClass("expand collapse"),e.closest(".is-collapsible, .window").toggleClass(t),e.closest(".is-collapsible").children("article").slideToggle()},a=function(){e(".ui-loading").show()},u=function(){e(".ui-loading").hide()},c=function(e,t,n,r,s){return new o.Warning({title:e,message:t,actions:{primary:{text:n,click:function(e){e.hide(),r()}},secondary:{text:i("Cancel"),click:function(e){return s&&s(),e.hide()}}}}).show()},l=function(e,t){var n;return n=new r.Mini({title:i(e)}),n.show(),t().done(function(){n.hide()})},p=function(t){return function(n){var i=this;d(e(n.currentTarget),function(){return i[t].apply(i,[n])})}},d=function(e,t){return e.addClass("is-disabled").attr("aria-disabled",!0),t().always(function(){e.removeClass("is-disabled").attr("aria-disabled",!1)})},x=function(t){return function(n){n.preventDefault(),e.ajax({url:e(this).data("dismiss-link"),type:"DELETE",success:t})}},g=function(t){e("html, body").animate({scrollTop:t},500)},h=function(t){var n=t.offset().top;return n-e(window).scrollTop()},f=function(e,t){var n=e.offset().top,i=n-t;g(i)},m=function(e){window.location=e},v=function(){window.location.reload()},w=function(e,t){var i,r=e.changedAttributes();if(!r)return!1;for(i=0;i<t.length;i++)if(n.has(r,t[i]))return!0;return!1},y=function(e){return 0===e.length?i("Required field."):""},b=function(e,t){var n=y(e);if(n)return n;if(t){if(/\s/g.test(e))return i("Please do not use any spaces in this field.")}else if(e!==encodeURIComponent(e)||e.match(/[!'()*]/))return i("Please do not use any spaces or special characters in this field.");return""},S=function(t){var i=n.reduce(t,function(t,n){return t+e(n).val().length},0);return C>=i},k=function(t,i,r,o){S(r)?e(t.errorWrapper).removeClass(i.shown).addClass(i.hiding):(e(t.errorWrapper).addClass(i.shown).removeClass(i.hiding),e(t.errorMessage).html("<p>"+n.template(o)({limit:C})+"</p>"),e(t.save).addClass(i.disabled))},j=function(n){var i=e.Deferred();return t([n],function(){i.resolve()},function(){i.reject()}),i.promise()},{toggleExpandCollapse:s,showLoadingIndicator:a,hideLoadingIndicator:u,confirmThenRunOperation:c,runOperationShowingMessage:l,withDisabledElement:p,disableElementWhileRunning:d,deleteNotificationHandler:x,setScrollTop:g,getScrollOffset:h,setScrollOffset:f,redirect:m,reload:v,hasChangedAttributes:w,validateRequiredField:y,validateURLItemEncoding:b,validateTotalKeyLength:S,checkTotalKeyLengthViolations:k,loadJavaScript:j}})}.call(this,define||RequireJS.define,require||RequireJS.require),define("js/views/baseview",["jquery","underscore","backbone","gettext","js/utils/handle_iframe_binding","js/utils/templates","common/js/components/utils/view_utils"],function(e,t,n,i,r,o,s){var a=n.View.extend({events:{"click .ui-toggle-expansion":"toggleExpandCollapse"},options:{collapsedClass:"collapsed"},constructor:function(e){t.bindAll(this,"beforeRender","render","afterRender"),this.options&&(e=t.extend({},t.result(this,"options"),e)),this.options=e;var i=this;this.render=t.wrap(this.render,function(e,t){return i.beforeRender(),e(t),i.afterRender(),i}),n.View.prototype.constructor.apply(this,arguments)},beforeRender:function(){},render:function(){return this},afterRender:function(){r.iframeBinding(this)},toggleExpandCollapse:function(t){var n=e(t.target);t.stopPropagation(),t.preventDefault(),s.toggleExpandCollapse(n,this.options.collapsedClass)},loadTemplate:function(e){return o.loadTemplate(e)}});return a}),define("js/views/pages/base_page",["jquery","js/views/baseview"],function(e,t){var n=t.extend({initialize:function(){t.prototype.initialize.call(this)},hasContent:function(){return!0},renderPage:function(){return e.Deferred().resolve().promise()},render:function(){var e=this;return this.$(".ui-loading").removeClass("is-hidden"),this.renderPage().done(function(){e.hasContent()||e.$(".no-content").removeClass("is-hidden")}).always(function(){e.$(".ui-loading").addClass("is-hidden")}),this}});return n}),define("js/views/list",["js/views/baseview"],function(e){"use strict";var t=e.extend({events:{"click .action-add":"onAddItem","click .new-button":"onAddItem"},listContainerCss:".list-items",initialize:function(){this.listenTo(this.collection,"add",this.addNewItemView),this.listenTo(this.collection,"remove",this.onRemoveItem),this.template=this.loadTemplate("list"),this.listenTo(this.collection,"change:editing",this.toggleAddButton),this.listenTo(this.collection,"add",this.toggleAddButton),this.listenTo(this.collection,"remove",this.toggleAddButton)},render:function(e){return this.$el.html(this.template({itemCategoryDisplayName:this.itemCategoryDisplayName,newItemMessage:this.newItemMessage,emptyMessage:this.emptyMessage,length:this.collection.length,isEditing:e&&e.get("editing"),canCreateNewItem:this.canCreateItem(this.collection)})),this.collection.each(function(e){this.$(this.listContainerCss).append(this.createItemView({model:e}).render().el)},this),this},hideOrShowAddButton:function(e){var t=".action-add";this.collection.length&&(e?this.$(t).removeClass("is-hidden"):this.$(t).addClass("is-hidden"))},toggleAddButton:function(e){e.get("editing")&&this.collection.contains(e)?this.hideOrShowAddButton(!1):this.hideOrShowAddButton(!0)},addNewItemView:function(e){var t=this.createItemView({model:e});this.collection.length>1?this.$(this.listContainerCss).append(t.render().el):this.render(),t.$el.focus()},canCreateItem:function(e){var t=!0;if(e.length>0){var n=e.maxAllowed;!_.isUndefined(n)&&e.length>=n&&(t=!1)}return t},onAddItem:function(e){e&&e.preventDefault&&e.preventDefault(),this.collection.add({editing:!0},this.newModelOptions)},onRemoveItem:function(){0===this.collection.length&&this.render()}});return t}),define("js/views/list_item",["js/views/baseview","jquery","gettext","common/js/components/utils/view_utils"],function(e,t,n,i){"use strict";var r=e.extend({canDelete:!1,initialize:function(){this.listenTo(this.model,"change:editing",this.render),this.listenTo(this.model,"remove",this.remove)},className:function(){var e=this.model.collection.indexOf(this.model);return["wrapper-collection","wrapper-collection-"+e,this.baseClassName,this.baseClassName+"s-list-item",this.baseClassName+"s-list-item-"+e].join(" ")},deleteItem:function(e){if(e&&e.preventDefault&&e.preventDefault(),this.canDelete){var t=this.model,r=this.itemDisplayName;i.confirmThenRunOperation(interpolate(n("Delete this %(item_display_name)s?"),{item_display_name:r},!0),interpolate(n("Deleting this %(item_display_name)s is permanent and cannot be undone."),{item_display_name:r},!0),n("Delete"),function(){return i.runOperationShowingMessage(n("Deleting"),function(){return t.destroy({wait:!0})})})}},render:function(){return this.view&&this.view.remove(),this.model.get("editing")?this.view=this.createEditView():this.view=this.createDetailsView(),this.$el.html(this.view.render().el),this}});return r}),define("js/views/group_configuration_details",["js/views/baseview","underscore","gettext","underscore.string","edx-ui-toolkit/js/utils/string-utils","edx-ui-toolkit/js/utils/html-utils"],function(e,t,n,i,r,o){"use strict";var s=e.extend({tagName:"div",events:{"click .edit":"editConfiguration","click .show-groups":"showGroups","click .hide-groups":"hideGroups"},className:function(){var e=this.model.collection.indexOf(this.model);return["collection","group-configuration-details","group-configuration-details-"+e].join(" ")},initialize:function(){this.template=o.template($("#group-configuration-details-tpl").text()),this.listenTo(this.model,"change",this.render)},render:function(){var e=$.extend({},this.model.attributes,{groupsCountMessage:this.getGroupsCountTitle(),usageCountMessage:this.getUsageCountTitle(),courseOutlineUrl:this.model.collection.outlineUrl,index:this.model.collection.indexOf(this.model)});return o.setHtml(this.$el,this.template(e)),this},editConfiguration:function(e){e&&e.preventDefault&&e.preventDefault(),this.model.set("editing",!0)},showGroups:function(e){e&&e.preventDefault&&e.preventDefault(),this.model.set("showGroups",!0)},hideGroups:function(e){e&&e.preventDefault&&e.preventDefault(),this.model.set("showGroups",!1)},getGroupsCountTitle:function(){var e=this.model.get("groups").length,t=ngettext("Contains {count} group","Contains {count} groups",e);return r.interpolate(t,{count:e})},getUsageCountTitle:function(){var e=this.model.get("usage").length;return 0===e?n("Not in Use"):r.interpolate(ngettext("Used in {count} unit","Used in {count} units",e),{count:e})}});return s}),define("js/views/list_item_editor",["js/views/baseview","common/js/components/utils/view_utils","underscore","gettext"],function(e,t,n,i){"use strict";var r=e.extend({initialize:function(){this.listenTo(this.model,"invalid",this.render),this.listenTo(this.getSaveableModel(),"invalid",this.render)},render:function(){this.$el.html(this.template(n.extend({error:this.model.validationError||this.getSaveableModel().validationError},this.getTemplateOptions())))},setAndClose:function(e){return e&&e.preventDefault&&e.preventDefault(),this.setValues(),this.model.isValid()&&this.getSaveableModel().isValid()?void t.runOperationShowingMessage(i("Saving"),function(){var e=$.Deferred(),t=this.getSaveableModel();return t.save({},{success:function(){t.setOriginalAttributes(),this.close(),e.resolve()}.bind(this)}),e}.bind(this)):!1},cancel:function(e){return e&&e.preventDefault&&e.preventDefault(),this.getSaveableModel().reset(),this.close()},close:function(){return this.remove(),this.model.isNew()&&!n.isUndefined(this.model.collection)?this.model.collection.remove(this.model):this.model.set("editing",!1),this}});return r}),define("text!templates/group-edit.underscore",[],function(){return'<div class="input-wrap field long text required field-add-group-name group-<%- index %>-name\n    <% if (error && error.attributes && error.attributes.name) { print(\'error\'); } %>"><input name="group-<%- index %>-name" class="group-name long" value="<%- name %>" type="text">\n</div><div class="group-allocation"><%- allocation %>%</div>\n<a href="" class="action action-close"><span class="icon fa fa-times-circle" aria-hidden="true"></span> <span class="sr"><%- gettext("delete group") %></span></a>\n'}),define("js/views/experiment_group_edit",["js/views/baseview","underscore","underscore.string","gettext","text!templates/group-edit.underscore"],function(e,t,n,i,r){"use strict";var o=e.extend({tagName:"li",events:{"click .action-close":"removeGroup","change .group-name":"changeName","focus .group-name":"onFocus","blur .group-name":"onBlur"},className:function(){var e=this.model.collection.indexOf(this.model);return"field-group group group-"+e},initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){var e=this.model.collection,n=e.indexOf(this.model);return this.$el.html(t.template(r)({name:this.model.get("name"),allocation:this.getAllocation(),index:n,error:this.model.validationError})),this},changeName:function(e){return e&&e.preventDefault&&e.preventDefault(),this.model.set({name:this.$(".group-name").val()},{silent:!0}),this},removeGroup:function(e){return e&&e.preventDefault&&e.preventDefault(),this.model.collection.remove(this.model),this.remove()},getAllocation:function(){return Math.floor(100/this.model.collection.length)},onFocus:function(){this.$el.closest(".groups-fields").addClass("is-focused")},onBlur:function(){this.$el.closest(".groups-fields").removeClass("is-focused")}});return o}),define("js/views/group_configuration_editor",["js/views/list_item_editor","underscore","jquery","gettext","js/views/experiment_group_edit"],function(e,t,n,i,r){"use strict";var o=e.extend({tagName:"div",events:{"change .collection-name-input":"setName","change .group-configuration-description-input":"setDescription","click .action-add-group":"createGroup","focus .input-text":"onFocus","blur .input-text":"onBlur",submit:"setAndClose","click .action-cancel":"cancel"},className:function(){var e=this.model.collection.indexOf(this.model);return["collection-edit","group-configuration-edit","group-configuration-edit-"+e].join(" ")},initialize:function(){var t=this.model.get("groups");e.prototype.initialize.call(this),this.template=this.loadTemplate("group-configuration-editor"),this.listenTo(t,"add",this.onAddItem),this.listenTo(t,"reset",this.addAll),this.listenTo(t,"all",this.render)},render:function(){return e.prototype.render.call(this),this.addAll(),this},getTemplateOptions:function(){return{id:this.model.get("id"),uniqueId:t.uniqueId(),name:this.model.get("name"),description:this.model.get("description"),usage:this.model.get("usage"),isNew:this.model.isNew()}},getSaveableModel:function(){return this.model},onAddItem:function(e){var t=new r({model:e});return this.$("ol.groups").append(t.render().el),this},addAll:function(){this.model.get("groups").each(this.onAddItem,this)},createGroup:function(e){e&&e.preventDefault&&e.preventDefault();var t=this.model.get("groups");t.add([{name:t.getNextDefaultGroupName(),order:t.nextOrder()}])},setName:function(e){e&&e.preventDefault&&e.preventDefault(),this.model.set("name",this.$(".collection-name-input").val(),{silent:!0})},setDescription:function(e){e&&e.preventDefault&&e.preventDefault(),this.model.set("description",this.$(".group-configuration-description-input").val(),{silent:!0})},setValues:function(){return this.setName(),this.setDescription(),t.each(this.$(".groups li"),function(e,t){var i=this.model.get("groups").at(t);i&&i.set({name:n(".group-name",e).val()})},this),this}});return o}),define("js/views/group_configuration_item",["js/views/list_item","js/views/group_configuration_details","js/views/group_configuration_editor","gettext"],function(e,t,n,i){"use strict";var r=e.extend({events:{"click .delete":"deleteItem"},tagName:"section",baseClassName:"group-configuration",canDelete:!0,itemDisplayName:i("group configuration"),attributes:function(){return{id:this.model.get("id"),tabindex:-1}},createEditView:function(){return new n({model:this.model})},createDetailsView:function(){return new t({model:this.model})}});return r}),define("js/views/group_configurations_list",["js/views/list","js/views/group_configuration_item","gettext"],function(e,t,n){"use strict";var i=e.extend({tagName:"div",className:"group-configurations-list",newModelOptions:{addDefaultGroups:!0},itemCategoryDisplayName:n("group configuration"),newItemMessage:n("Add your first group configuration"),emptyMessage:n("You have not created any group configurations yet."),createItemView:function(e){return new t(e)}});return i}),define("js/views/content_group_editor",["js/views/list_item_editor","underscore"],function(e,t){"use strict";var n=e.extend({tagName:"div",className:"content-group-edit collection-edit",events:{submit:"setAndClose","click .action-cancel":"cancel"},initialize:function(){e.prototype.initialize.call(this),this.template=this.loadTemplate("content-group-editor")},getTemplateOptions:function(){return{id:this.model.get("id"),name:this.model.get("name"),index:this.model.collection.indexOf(this.model),isNew:this.model.isNew(),usage:this.model.get("usage"),uniqueId:t.uniqueId()}},setValues:function(){return this.model.set({name:this.$("input").val().trim()}),this},getSaveableModel:function(){return this.model.collection.parents[0]}});return n}),define("js/views/content_group_details",["js/views/baseview","underscore","gettext","underscore.string","edx-ui-toolkit/js/utils/string-utils","edx-ui-toolkit/js/utils/html-utils"],function(e,t,n,i,r,o){"use strict";var s=e.extend({tagName:"div",events:{"click .edit":"editGroup","click .show-groups":"showContentGroupUsages","click .hide-groups":"hideContentGroupUsages"},className:function(){var e=this.model.collection.indexOf(this.model);return["collection","content-group-details","content-group-details-"+e].join(" ")},editGroup:function(){this.model.set({editing:!0})},initialize:function(){this.template=this.loadTemplate("content-group-details"),this.listenTo(this.model,"change",this.render)},render:function(e){var t=$.extend({},this.model.attributes,{usageCountMessage:this.getUsageCountTitle(),courseOutlineUrl:this.model.collection.parents[0].outlineUrl,index:this.model.collection.indexOf(this.model),showContentGroupUsages:e||!1,HtmlUtils:o});return this.$el.html(this.template(t)),this},showContentGroupUsages:function(e){e&&e.preventDefault&&e.preventDefault(),this.render(!0)},hideContentGroupUsages:function(e){e&&e.preventDefault&&e.preventDefault(),this.render(!1)},getUsageCountTitle:function(){var e=this.model.get("usage").length;return 0===e?n("Not in Use"):r.interpolate(ngettext("Used in {count} unit","Used in {count} units",e),{count:e})}});return s}),define("js/views/content_group_item",["js/views/list_item","js/views/content_group_editor","js/views/content_group_details","gettext","common/js/components/utils/view_utils"],function(e,t,n,i){"use strict";var r=e.extend({events:{"click .delete":"deleteItem"},tagName:"section",baseClassName:"content-group",canDelete:!0,itemDisplayName:i("content group"),attributes:function(){return{id:this.model.get("id"),tabindex:-1}},createEditView:function(){return new t({model:this.model})},createDetailsView:function(){return new n({model:this.model})}});return r}),define("js/views/content_group_list",["js/views/list","js/views/content_group_item","gettext"],function(e,t,n){"use strict";var i=e.extend({tagName:"div",className:"content-group-list",itemCategoryDisplayName:n("content group"),newItemMessage:n("Add your first content group"),emptyMessage:n("You have not created any content groups yet."),createItemView:function(e){return new t(e)}});return i}),define("js/views/pages/group_configurations",["jquery","underscore","gettext","js/views/pages/base_page","js/views/group_configurations_list","js/views/content_group_list"],function(e,t,n,i,r,o){"use strict";var s=i.extend({initialize:function(e){i.prototype.initialize.call(this),this.experimentsEnabled=e.experimentsEnabled,this.experimentsEnabled&&(this.experimentGroupConfigurations=e.experimentGroupConfigurations,this.experimentGroupsListView=new r({collection:this.experimentGroupConfigurations})),this.contentGroupConfiguration=e.contentGroupConfiguration,this.cohortGroupsListView=new o({collection:this.contentGroupConfiguration.get("groups")})},renderPage:function(){var t=this.getLocationHash();return this.experimentsEnabled&&this.$(".wrapper-groups.experiment-groups").append(this.experimentGroupsListView.render().el),this.$(".wrapper-groups.content-groups").append(this.cohortGroupsListView.render().el),this.addWindowActions(),t&&this.expandConfiguration(t.replace("#","")),e.Deferred().resolve().promise()},addWindowActions:function(){e(window).on("beforeunload",this.onBeforeUnload.bind(this))},onBeforeUnload:function(){var e=this.contentGroupConfiguration.isDirty()||this.experimentsEnabled&&this.experimentGroupConfigurations.find(function(e){return e.isDirty()});return e?n("You have unsaved changes. Do you really want to leave this page?"):void 0},getLocationHash:function(){return window.location.hash},expandConfiguration:function(e){var t=this.experimentsEnabled&&this.experimentGroupConfigurations.findWhere({id:parseInt(e)});t&&(t.set("showGroups",!0),this.$("#"+e).focus())}});return s}),define("js/factories/group_configurations",["js/collections/group_configuration","js/models/group_configuration","js/views/pages/group_configurations"],function(e,t,n){"use strict";return function(i,r,o,s,a){var u=new e(r,{parse:!0}),c=new t(o,{parse:!0,canBeEmpty:!0});u.url=s,u.outlineUrl=a,c.urlRoot=s,c.outlineUrl=a,new n({el:$("#content"),experimentsEnabled:i,experimentGroupConfigurations:u,contentGroupConfiguration:c}).render()}});